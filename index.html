<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gov Jornal - Desastres Ambientais</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-bg: #000000;
            --secondary-bg: #1c1c1e;
            --tertiary-bg: #2c2c2e;
            --card-bg: #1c1c1e;
            --text-primary: #ffffff;
            --text-secondary: #98989d;
            --accent-color: #007aff;
            --accent-hover: #0051d5;
            --border-color: #38383a;
            --success-color: #34c759;
            --warning-color: #ff9500;
            --danger-color: #ff3b30;
            --shadow: rgba(0, 0, 0, 0.5);
            --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            background: var(--primary-bg);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Header */
        header {
            background: rgba(28, 28, 30, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
            transition: transform 0.3s ease;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            text-decoration: none;
        }

        .logo i {
            color: var(--accent-color);
            font-size: 2rem;
        }

        .nav-menu {
            display: flex;
            gap: 2rem;
            list-style: none;
            align-items: center;
        }

        .nav-menu a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
            font-size: 0.95rem;
        }

        .nav-menu a:hover {
            color: var(--text-primary);
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .user-avatar:hover {
            transform: scale(1.1);
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .btn-primary {
            background: var(--accent-color);
            color: white;
            padding: 0.6rem 1.5rem;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 0.95rem;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 122, 255, 0.3);
        }

        .btn-secondary {
            background: var(--secondary-bg);
            color: white;
            padding: 0.6rem 1.5rem;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            border: 1px solid var(--border-color);
            cursor: pointer;
        }

        .btn-secondary:hover {
            background: var(--tertiary-bg);
            transform: translateY(-2px);
        }

        /* Hero Section */
        .hero {
            margin-top: 80px;
            padding: 4rem 2rem;
            background: linear-gradient(135deg, var(--secondary-bg) 0%, var(--primary-bg) 100%);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(0, 122, 255, 0.1) 0%, transparent 70%);
            animation: rotate 30s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hero-content {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .hero h1 {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #ffffff 0%, #007aff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: fadeInUp 0.8s ease;
        }

        .hero p {
            font-size: 1.25rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
            animation: fadeInUp 0.8s ease 0.2s both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }

        /* Section Title */
        .section-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-align: center;
        }

        .section-subtitle {
            text-align: center;
            color: var(--text-secondary);
            margin-bottom: 3rem;
            font-size: 1.1rem;
        }

        /* 3D Planet Section */
        .planet-section {
            background: var(--secondary-bg);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 4rem;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .planet-container {
            width: 100%;
            height: 600px;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 20px 60px var(--shadow);
        }

        .planet-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Video Section */
        .video-section {
            background: var(--secondary-bg);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 4rem;
            border: 1px solid var(--border-color);
        }

        .video-container {
            background: var(--tertiary-bg);
            border-radius: 16px;
            overflow: hidden;
            aspect-ratio: 16/9;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .video-placeholder {
            text-align: center;
            color: var(--text-secondary);
        }

        .video-placeholder i {
            font-size: 4rem;
            margin-bottom: 1rem;
            color: var(--accent-color);
        }

        /* Admin Upload */
        .admin-upload {
            display: none;
            margin-top: 2rem;
            padding: 2rem;
            background: var(--tertiary-bg);
            border-radius: 16px;
            border: 2px dashed var(--border-color);
        }

        .admin-upload.show {
            display: block;
        }

        .upload-area {
            text-align: center;
        }

        .upload-input {
            display: none;
        }

        .upload-label {
            display: inline-block;
            padding: 1rem 2rem;
            background: var(--accent-color);
            color: white;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-label:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
        }

        /* Disaster Cards Grid */
        .disaster-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            margin-bottom: 4rem;
        }

        .disaster-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid var(--border-color);
            transition: all 0.4s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .disaster-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, transparent 0%, rgba(0, 122, 255, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .disaster-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px var(--shadow);
            border-color: var(--accent-color);
        }

        .disaster-card:hover::before {
            opacity: 1;
        }

        .disaster-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: inline-block;
            transition: transform 0.4s ease;
        }

        .disaster-card:hover .disaster-icon {
            transform: scale(1.2) rotate(5deg);
        }

        .disaster-card h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .disaster-card p {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .disaster-card .learn-more {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem;
            color: var(--accent-color);
            font-weight: 600;
            text-decoration: none;
            transition: gap 0.3s ease;
        }

        .disaster-card:hover .learn-more {
            gap: 1rem;
        }

        /* Gallery Section */
        .gallery-section {
            margin-bottom: 4rem;
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .gallery-item {
            background: var(--card-bg);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            transition: all 0.4s ease;
            cursor: pointer;
            position: relative;
            aspect-ratio: 4/3;
        }

        .gallery-item:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 35px var(--shadow);
        }

        .gallery-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--tertiary-bg);
            color: var(--text-secondary);
        }

        .gallery-placeholder i {
            font-size: 3rem;
        }

        /* Reviews Section */
        .reviews-section {
            background: var(--secondary-bg);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 4rem;
            border: 1px solid var(--border-color);
        }

        .review-form {
            background: var(--tertiary-bg);
            padding: 2rem;
            border-radius: 16px;
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.875rem;
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            color: var(--text-primary);
            font-family: var(--font-family);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        .rating-input {
            display: flex;
            gap: 0.5rem;
            font-size: 2rem;
        }

        .rating-input i {
            cursor: pointer;
            color: var(--border-color);
            transition: all 0.3s ease;
        }

        .rating-input i:hover,
        .rating-input i.active {
            color: #ffd700;
            transform: scale(1.2);
        }

        .reviews-list {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .review-item {
            background: var(--tertiary-bg);
            padding: 1.5rem;
            border-radius: 16px;
            border: 1px solid var(--border-color);
            position: relative;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .review-user {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .review-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        .review-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .review-info h4 {
            font-size: 1.1rem;
            margin-bottom: 0.25rem;
        }

        .review-rating {
            color: #ffd700;
        }

        .review-date {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .review-text {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .delete-review {
            display: none;
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.3s ease;
        }

        .delete-review:hover {
            background: #cc0000;
            transform: scale(1.05);
        }

        .delete-review.show {
            display: block;
        }

        /* Settings Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: var(--secondary-bg);
            border-radius: 24px;
            padding: 2.5rem;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            animation: modalSlideIn 0.4s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .modal-header h2 {
            font-size: 1.75rem;
            font-weight: 700;
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: var(--text-primary);
        }

        .settings-section {
            margin-bottom: 2rem;
        }

        .settings-section h3 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: var(--accent-color);
        }

        .color-picker-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 1rem;
        }

        .color-option {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .color-option.active {
            border-color: var(--text-primary);
            box-shadow: 0 0 20px rgba(0, 122, 255, 0.5);
        }

        .font-option {
            padding: 1rem;
            background: var(--tertiary-bg);
            border-radius: 12px;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .font-option:hover {
            background: var(--card-bg);
        }

        .font-option.active {
            border-color: var(--accent-color);
            background: var(--card-bg);
        }

        /* Profile Section */
        .profile-section {
            display: none;
        }

        .profile-section.show {
            display: block;
        }

        .profile-card {
            background: var(--secondary-bg);
            border-radius: 24px;
            padding: 3rem;
            border: 1px solid var(--border-color);
            text-align: center;
        }

        .profile-avatar-large {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 2rem;
            font-size: 3rem;
            font-weight: 700;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .profile-avatar-large:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 122, 255, 0.3);
        }

        .profile-avatar-large img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .profile-name {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .profile-username {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border-color);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-color);
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        /* Footer */
        footer {
            background: var(--secondary-bg);
            border-top: 1px solid var(--border-color);
            padding: 4rem 2rem 2rem;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .footer-section h3 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: var(--accent-color);
        }

        .footer-section p,
        .footer-section a {
            color: var(--text-secondary);
            line-height: 1.8;
            text-decoration: none;
            display: block;
            transition: color 0.3s ease;
        }

        .footer-section a:hover {
            color: var(--text-primary);
        }

        .footer-section .contact-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .footer-section .contact-item i {
            color: var(--accent-color);
            width: 20px;
        }

        .creator-info {
            background: var(--tertiary-bg);
            padding: 2rem;
            border-radius: 16px;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
        }

        .creator-info h3 {
            color: var(--accent-color);
            margin-bottom: 1rem;
        }

        .creator-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .creator-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .creator-item i {
            color: var(--accent-color);
            font-size: 1.25rem;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid var(--border-color);
            color: var(--text-secondary);
        }

        /* Auth Forms */
        .auth-section {
            display: none;
            min-height: calc(100vh - 80px);
            padding: 4rem 2rem;
            align-items: center;
            justify-content: center;
        }

        .auth-section.show {
            display: flex;
        }

        .auth-container {
            background: var(--secondary-bg);
            border-radius: 24px;
            padding: 3rem;
            max-width: 500px;
            width: 100%;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 60px var(--shadow);
        }

        .auth-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .auth-header h2 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .auth-header p {
            color: var(--text-secondary);
        }

        .auth-toggle {
            text-align: center;
            margin-top: 1.5rem;
            color: var(--text-secondary);
        }

        .auth-toggle a {
            color: var(--accent-color);
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
        }

        .auth-toggle a:hover {
            color: var(--accent-hover);
        }

        .avatar-upload {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .avatar-preview {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--tertiary-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid var(--border-color);
        }

        .avatar-preview:hover {
            transform: scale(1.05);
            border-color: var(--accent-color);
        }

        .avatar-preview img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .avatar-preview i {
            font-size: 2.5rem;
            color: var(--text-secondary);
        }

        /* Loading */
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 3000;
            align-items: center;
            justify-content: center;
        }

        .loading.show {
            display: flex;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border-color);
            border-top-color: var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .disaster-grid,
            .gallery-grid {
                grid-template-columns: 1fr;
            }

            .profile-stats {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .footer-grid {
                grid-template-columns: 1fr;
            }
            
            .planet-container {
                height: 400px;
            }
        }

        /* Rainbow Accent */
        .rainbow {
            background: linear-gradient(90deg, 
                #ff0000, #ff7f00, #ffff00, #00ff00, 
                #0000ff, #4b0082, #9400d3);
            background-size: 200% 200%;
            animation: rainbow 3s ease infinite;
        }

        @keyframes rainbow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .logo-parana {
            max-width: 200px;
            margin: 2rem auto;
            display: block;
        }

        /* Admin Panel */
        .admin-panel {
            display: none;
            background: var(--secondary-bg);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 4rem;
            border: 1px solid var(--border-color);
        }

        .admin-panel.show {
            display: block;
        }

        .admin-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 1rem;
        }

        .admin-tab {
            padding: 0.75rem 1.5rem;
            background: var(--tertiary-bg);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .admin-tab.active {
            background: var(--accent-color);
            color: white;
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        .admin-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--tertiary-bg);
            border-radius: 16px;
        }

        .admin-section h3 {
            margin-bottom: 1rem;
            color: var(--accent-color);
        }

        .admin-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        /* Edit Profile */
        .edit-profile-form {
            max-width: 500px;
            margin: 0 auto;
        }

        /* Disaster Detail Modal */
        .disaster-detail-modal {
            max-width: 800px;
        }

        .disaster-detail-content {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .disaster-detail-image {
            width: 100%;
            border-radius: 16px;
            overflow: hidden;
            aspect-ratio: 16/9;
        }

        .disaster-detail-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .disaster-detail-text {
            line-height: 1.8;
            color: var(--text-secondary);
        }

        .disaster-admin-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <!-- Loading -->
    <div class="loading" id="loading">
        <div class="spinner"></div>
    </div>

    <!-- Header -->
    <header>
        <div class="header-content">
            <a href="#" class="logo">
                <i class="fas fa-globe-americas"></i>
                <span>Gov Jornal</span>
            </a>
            <nav>
                <ul class="nav-menu">
                    <li><a href="#home">Início</a></li>
                    <li><a href="#disasters">Desastres</a></li>
                    <li><a href="#gallery">Galeria</a></li>
                    <li><a href="#reviews">Avaliações</a></li>
                    <li><a href="#about">Sobre</a></li>
                </ul>
            </nav>
            <div class="user-section">
                <button class="btn-secondary" onclick="openSettings()">
                    <i class="fas fa-cog"></i> Configurações
                </button>
                <div class="user-avatar" id="userAvatar" onclick="toggleProfile()">
                    <i class="fas fa-user"></i>
                </div>
            </div>
        </div>
    </header>

    <!-- Auth Section -->
    <section class="auth-section" id="authSection">
        <div class="auth-container">
            <div class="auth-header">
                <h2 id="authTitle">Entrar</h2>
                <p id="authSubtitle">Faça login para continuar</p>
            </div>
            
            <!-- Login Form -->
            <form id="loginForm" class="auth-form">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" placeholder="seu@email.com" required>
                </div>
                <div class="form-group">
                    <label>Senha</label>
                    <input type="password" id="loginPassword" placeholder="••••••••" required>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">Entrar</button>
            </form>

            <!-- Register Form -->
            <form id="registerForm" class="auth-form" style="display: none;">
                <div class="avatar-upload">
                    <div class="avatar-preview" id="avatarPreview" onclick="document.getElementById('avatarInput').click()">
                        <i class="fas fa-camera"></i>
                    </div>
                    <input type="file" id="avatarInput" accept="image/*" style="display: none;" onchange="previewAvatar(event)">
                    <p style="color: var(--text-secondary); font-size: 0.875rem;">Clique para adicionar foto</p>
                </div>
                <div class="form-group">
                    <label>Nome Completo</label>
                    <input type="text" id="registerFullName" placeholder="Nome Completo" required>
                </div>
                <div class="form-group">
                    <label>Apelido</label>
                    <input type="text" id="registerNickname" placeholder="Apelido" required>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="registerEmail" placeholder="seu@email.com" required>
                </div>
                <div class="form-group">
                    <label>Senha</label>
                    <input type="password" id="registerPassword" placeholder="••••••••" required>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">Criar Conta</button>
            </form>

            <div class="auth-toggle">
                <p id="authToggleText">
                    Não tem uma conta? 
                    <a href="#" onclick="toggleAuthForm(); return false;">Cadastre-se</a>
                </p>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main id="mainContent" style="display: none;">
        <!-- Hero -->
        <section class="hero" id="home">
            <div class="hero-content">
                <h1>Desastres Ambientais</h1>
                <p>Informação de qualidade sobre os principais eventos que impactam nosso planeta</p>
                <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 2rem;">
                    <a href="#disasters" class="btn-primary">Explorar Desastres</a>
                    <a href="#reviews" class="btn-secondary">Avaliar Site</a>
                </div>
            </div>
        </section>

        <!-- Admin Panel -->
        <div class="container">
            <div class="admin-panel" id="adminPanel">
                <h2 class="section-title">Painel de Administrador</h2>
                <div class="admin-tabs">
                    <div class="admin-tab active" data-tab="content">Gerenciar Conteúdo</div>
                    <div class="admin-tab" data-tab="reviews">Gerenciar Avaliações</div>
                    <div class="admin-tab" data-tab="users">Gerenciar Usuários</div>
                </div>
                <div class="admin-content active" id="content-tab">
                    <div class="admin-section">
                        <h3>Gerenciar Vídeo</h3>
                        <div class="form-group">
                            <label>URL do Vídeo do YouTube</label>
                            <input type="text" id="videoUrl" placeholder="https://www.youtube.com/embed/..." value="">
                        </div>
                        <div class="admin-controls">
                            <button class="btn-primary" onclick="saveVideoUrl()">Salvar URL</button>
                        </div>
                    </div>
                    <div class="admin-section">
                        <h3>Gerenciar Conteúdo dos Desastres</h3>
                        <div class="form-group">
                            <label>Selecionar Desastre</label>
                            <select id="disasterSelect">
                                <option value="floods">Enchentes</option>
                                <option value="droughts">Seca</option>
                                <option value="fires">Incêndios</option>
                                <option value="earthquakes">Terremotos</option>
                                <option value="hurricanes">Furacões</option>
                                <option value="landslides">Deslizamentos</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Imagem do Desastre</label>
                            <div class="upload-area">
                                <input type="file" id="disasterImageInput" accept="image/*" class="upload-input" onchange="previewDisasterImage(event)">
                                <label for="disasterImageInput" class="upload-label">
                                    <i class="fas fa-upload"></i> Escolher Imagem
                                </label>
                            </div>
                            <div id="disasterImagePreview" style="margin-top: 1rem; display: none;">
                                <img id="previewImg" style="max-width: 100%; border-radius: 12px;">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Descrição Detalhada</label>
                            <textarea id="disasterDescription" rows="6" placeholder="Descrição detalhada sobre o desastre..."></textarea>
                        </div>
                        <div class="admin-controls">
                            <button class="btn-primary" onclick="saveDisasterContent()">Salvar Conteúdo</button>
                            <button class="btn-secondary" onclick="resetDisasterContent()">Redefinir</button>
                        </div>
                    </div>
                </div>
                <div class="admin-content" id="reviews-tab">
                    <div class="admin-section">
                        <h3>Avaliações dos Usuários</h3>
                        <div id="adminReviewsList" class="reviews-list">
                            <!-- Reviews will be populated here -->
                        </div>
                    </div>
                </div>
                <div class="admin-content" id="users-tab">
                    <div class="admin-section">
                        <h3>Usuários Registrados</h3>
                        <div id="usersList">
                            <!-- Users will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3D Planet -->
        <div class="container">
            <div class="planet-section">
                <h2 class="section-title">Terra em Tempo Real</h2>
                <p class="section-subtitle">Visualize nosso planeta em 3D e acompanhe eventos climáticos</p>
                <div class="planet-container">
                    <iframe src="https://earth.nullschool.net/pt/" frameborder="0"></iframe>
                </div>
            </div>
        </div>

        <!-- Video Section -->
        <div class="container">
            <div class="video-section">
                <h2 class="section-title">Vídeo Informativo</h2>
                <p class="section-subtitle">Entenda melhor os desastres ambientais e suas causas</p>
                <div class="video-container" id="videoContainer">
                    <div class="video-placeholder" id="videoPlaceholder">
                        <i class="fas fa-play-circle"></i>
                        <h3>Vídeo do YouTube</h3>
                        <p>O administrador pode adicionar um vídeo aqui</p>
                    </div>
                </div>
                <div class="admin-upload" id="videoUpload">
                    <div class="form-group">
                        <label>URL do Vídeo do YouTube (embed)</label>
                        <input type="text" id="adminVideoUrl" placeholder="https://www.youtube.com/embed/...">
                    </div>
                    <button class="btn-primary" onclick="saveVideo()">Salvar Vídeo</button>
                </div>
            </div>
        </div>

        <!-- Disaster Cards -->
        <div class="container" id="disasters">
            <h2 class="section-title">Tipos de Desastres Ambientais</h2>
            <p class="section-subtitle">Conheça os principais desastres ambientais e seus impactos</p>
            <div class="disaster-grid">
                <!-- Disaster cards will be populated here -->
            </div>
        </div>

        <!-- Gallery -->
        <div class="container" id="gallery">
            <h2 class="section-title">Galeria de Imagens</h2>
            <p class="section-subtitle">Registros visuais de desastres ambientais ao redor do mundo</p>
            <div class="gallery-grid" id="galleryGrid">
                <!-- Gallery items will be populated here -->
            </div>
        </div>

        <!-- Reviews -->
        <div class="container" id="reviews">
            <div class="reviews-section">
                <h2 class="section-title">Avaliações</h2>
                <p class="section-subtitle">Sua opinião é importante para melhorarmos nosso conteúdo</p>
                
                <div class="review-form">
                    <h3 style="margin-bottom: 1.5rem;">Deixe sua Avaliação</h3>
                    <div class="form-group">
                        <label>Nome</label>
                        <input type="text" id="reviewName" placeholder="Seu nome">
                    </div>
                    <div class="form-group">
                        <label>Avaliação</label>
                        <textarea id="reviewText" placeholder="Escreva sua avaliação aqui..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Classificação</label>
                        <div class="rating-input">
                            <i class="fas fa-star" data-rating="1"></i>
                            <i class="fas fa-star" data-rating="2"></i>
                            <i class="fas fa-star" data-rating="3"></i>
                            <i class="fas fa-star" data-rating="4"></i>
                            <i class="fas fa-star" data-rating="5"></i>
                        </div>
                    </div>
                    <button class="btn-primary" id="submitReview">Enviar Avaliação</button>
                </div>
                
                <div class="reviews-list" id="reviewsList">
                    <!-- Reviews will be populated here -->
                </div>
            </div>
        </div>

        <!-- Profile Section -->
        <div class="container">
            <div class="profile-section" id="profileSection">
                <div class="profile-card">
                    <div class="profile-avatar-large" id="profileAvatarLarge" onclick="openEditProfile()">
                        <i class="fas fa-user"></i>
                    </div>
                    <h1 class="profile-name" id="profileName">Nome do Usuário</h1>
                    <p class="profile-username" id="profileUsername">@usuario</p>
                    <p style="color: var(--text-secondary); margin-bottom: 2rem;">Membro desde <span id="memberSince">2023</span></p>
                    <div class="profile-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="reviewsCount">0</div>
                            <div class="stat-label">Avaliações</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="daysActive">0</div>
                            <div class="stat-label">Dias Ativo</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="contributionScore">0</div>
                            <div class="stat-label">Pontuação</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer id="about">
            <div class="footer-content">
                <div class="creator-info">
                    <h3>Criador do Projeto</h3>
                    <div class="creator-details">
                        <div class="creator-item">
                            <i class="fas fa-user"></i>
                            <div>
                                <strong>Kauã Willy</strong>
                                <p>Desenvolvedor</p>
                            </div>
                        </div>
                        <div class="creator-item">
                            <i class="fas fa-envelope"></i>
                            <div>
                                <strong>Email</strong>
                                <p>kartywillytdc@gmail.com</p>
                            </div>
                        </div>
                        <div class="creator-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <div>
                                <strong>Localização</strong>
                                <p>Paraná, Brasil</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="footer-grid">
                    <div class="footer-section">
                        <h3>Sobre Nós</h3>
                        <p>O Gov Jornal é uma plataforma informativa dedicada a fornecer conteúdo de qualidade sobre desastres ambientais e suas consequências.</p>
                    </div>
                    <div class="footer-section">
                        <h3>Links Rápidos</h3>
                        <a href="#home">Início</a>
                        <a href="#disasters">Desastres</a>
                        <a href="#gallery">Galeria</a>
                        <a href="#reviews">Avaliações</a>
                    </div>
                    <div class="footer-section">
                        <h3>Contato</h3>
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <span>contato@govjornal.com</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-phone"></i>
                            <span>+55 (41) 99999-9999</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Curitiba, Paraná</span>
                        </div>
                    </div>
                </div>
                <div class="footer-bottom">
                    <p>&copy; 2023 Gov Jornal. Todos os direitos reservados.</p>
                </div>
            </div>
        </footer>
    </main>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Configurações</h2>
                <button class="close-modal" onclick="closeSettings()">&times;</button>
            </div>
            <div class="settings-section">
                <h3>Tema</h3>
                <div class="color-picker-grid">
                    <div class="color-option active" style="background: #000000;" data-theme="dark"></div>
                    <div class="color-option" style="background: #1c1c1e;" data-theme="darker"></div>
                    <div class="color-option" style="background: #2c2c2e;" data-theme="gray"></div>
                    <div class="color-option" style="background: #121212;" data-theme="black"></div>
                </div>
            </div>
            <div class="settings-section">
                <h3>Fonte</h3>
                <div class="font-option active" data-font="system">Sistema</div>
                <div class="font-option" data-font="roboto">Roboto</div>
                <div class="font-option" data-font="open-sans">Open Sans</div>
                <div class="font-option" data-font="montserrat">Montserrat</div>
            </div>
            <div class="settings-section">
                <h3>Conta</h3>
                <button class="btn-primary" onclick="openEditProfile()" style="width: 100%; margin-bottom: 1rem;">
                    <i class="fas fa-user-edit"></i> Editar Perfil
                </button>
                <button class="btn-secondary" onclick="logout()" style="width: 100%;">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div class="modal" id="editProfileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Editar Perfil</h2>
                <button class="close-modal" onclick="closeEditProfile()">&times;</button>
            </div>
            <div class="edit-profile-form">
                <div class="avatar-upload">
                    <div class="avatar-preview" id="editAvatarPreview" onclick="document.getElementById('editAvatarInput').click()">
                        <i class="fas fa-camera"></i>
                    </div>
                    <input type="file" id="editAvatarInput" accept="image/*" style="display: none;" onchange="previewEditAvatar(event)">
                    <p style="color: var(--text-secondary); font-size: 0.875rem; text-align: center;">Clique para alterar foto</p>
                </div>
                <div class="form-group">
                    <label>Nome Completo</label>
                    <input type="text" id="editFullName" placeholder="Nome Completo">
                </div>
                <div class="form-group">
                    <label>Apelido</label>
                    <input type="text" id="editNickname" placeholder="Apelido">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="editEmail" placeholder="seu@email.com">
                </div>
                <div class="admin-controls" style="margin-top: 2rem;">
                    <button class="btn-primary" onclick="saveProfile()">Salvar Alterações</button>
                    <button class="btn-secondary" onclick="closeEditProfile()">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Disaster Detail Modal -->
    <div class="modal" id="disasterDetailModal">
        <div class="modal-content disaster-detail-modal">
            <div class="modal-header">
                <h2 id="disasterDetailTitle">Detalhes do Desastre</h2>
                <button class="close-modal" onclick="closeDisasterDetail()">&times;</button>
            </div>
            <div class="disaster-detail-content">
                <div class="disaster-detail-image">
                    <img id="disasterDetailImage" src="" alt="Imagem do Desastre">
                </div>
                <div class="disaster-detail-text" id="disasterDetailText">
                    <!-- Disaster details will be populated here -->
                </div>
                <div class="disaster-admin-controls" id="disasterAdminControls" style="display: none;">
                    <button class="btn-primary" onclick="editDisasterContent()">Editar Conteúdo</button>
                    <button class="btn-secondary" onclick="closeDisasterDetail()">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration (obfuscated)
        const firebaseConfig = {
            apiKey: "AIzaSyC" + "4a1b2c3d4e5f6g7h8i9j0" + "k1l2m3n4o5p6q7r8s9t0",
            authDomain: "gov-jornal-" + "desastres.firebaseapp.com",
            projectId: "gov-jornal-" + "desastres",
            storageBucket: "gov-jornal-" + "desastres.appspot.com",
            messagingSenderId: "123456789" + "012",
            appId: "1:123456789012:web:" + "abcdef123456"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();

        // Global variables
        let currentUser = null;
        let isAdmin = false;
        let selectedRating = 0;
        let currentDisasterId = null;

        // DOM Elements
        const loadingElement = document.getElementById('loading');
        const authSection = document.getElementById('authSection');
        const mainContent = document.getElementById('mainContent');
        const adminPanel = document.getElementById('adminPanel');
        const profileSection = document.getElementById('profileSection');
        const userAvatar = document.getElementById('userAvatar');
        const reviewsList = document.getElementById('reviewsList');
        const disasterGrid = document.querySelector('.disaster-grid');
        const galleryGrid = document.getElementById('galleryGrid');
        const videoContainer = document.getElementById('videoContainer');
        const videoPlaceholder = document.getElementById('videoPlaceholder');

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            showLoading();
            initializeApp();
        });

        // Initialize application
        function initializeApp() {
            // Check authentication state
            auth.onAuthStateChanged(user => {
                if (user) {
                    currentUser = user;
                    checkAdminStatus(user.email);
                    loadUserProfile(user.uid);
                    showMainContent();
                } else {
                    showAuthSection();
                }
                hideLoading();
            });

            // Initialize rating stars
            initializeRatingStars();
            
            // Load initial content
            loadDisasterCards();
            loadGallery();
            loadReviews();
            loadVideo();
        }

        // Show loading screen
        function showLoading() {
            loadingElement.classList.add('show');
        }

        // Hide loading screen
        function hideLoading() {
            loadingElement.classList.remove('show');
        }

        // Show authentication section
        function showAuthSection() {
            authSection.classList.add('show');
            mainContent.style.display = 'none';
        }

        // Show main content
        function showMainContent() {
            authSection.classList.remove('show');
            mainContent.style.display = 'block';
        }

        // Toggle authentication form (login/register)
        function toggleAuthForm() {
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            const authTitle = document.getElementById('authTitle');
            const authSubtitle = document.getElementById('authSubtitle');
            const authToggleText = document.getElementById('authToggleText');

            if (loginForm.style.display !== 'none') {
                loginForm.style.display = 'none';
                registerForm.style.display = 'block';
                authTitle.textContent = 'Criar Conta';
                authSubtitle.textContent = 'Cadastre-se para acessar todos os recursos';
                authToggleText.innerHTML = 'Já tem uma conta? <a href="#" onclick="toggleAuthForm(); return false;">Entrar</a>';
            } else {
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
                authTitle.textContent = 'Entrar';
                authSubtitle.textContent = 'Faça login para continuar';
                authToggleText.innerHTML = 'Não tem uma conta? <a href="#" onclick="toggleAuthForm(); return false;">Cadastre-se</a>';
            }
        }

        // Initialize rating stars
        function initializeRatingStars() {
            const stars = document.querySelectorAll('.rating-input i');
            stars.forEach(star => {
                star.addEventListener('click', function() {
                    const rating = parseInt(this.getAttribute('data-rating'));
                    setRating(rating);
                });
            });
        }

        // Set rating value
        function setRating(rating) {
            selectedRating = rating;
            const stars = document.querySelectorAll('.rating-input i');
            stars.forEach(star => {
                const starRating = parseInt(star.getAttribute('data-rating'));
                if (starRating <= rating) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
        }

        // Check if user is admin
        function checkAdminStatus(email) {
            isAdmin = email === 'kartywillytdc@gmail.com';
            if (isAdmin) {
                adminPanel.classList.add('show');
            } else {
                adminPanel.classList.remove('show');
            }
        }

        // Load user profile
        function loadUserProfile(uid) {
            db.collection('users').doc(uid).get()
                .then(doc => {
                    if (doc.exists) {
                        const userData = doc.data();
                        updateProfileUI(userData);
                    } else {
                        // Create user profile if it doesn't exist
                        createUserProfile(uid);
                    }
                })
                .catch(error => {
                    console.error('Error loading user profile:', error);
                });
        }

        // Create user profile
        function createUserProfile(uid) {
            const userData = {
                fullName: currentUser.displayName || 'Usuário',
                nickname: currentUser.displayName || 'usuário',
                email: currentUser.email,
                avatarUrl: '',
                memberSince: new Date(),
                reviewsCount: 0,
                daysActive: 1,
                contributionScore: 10
            };

            db.collection('users').doc(uid).set(userData)
                .then(() => {
                    updateProfileUI(userData);
                })
                .catch(error => {
                    console.error('Error creating user profile:', error);
                });
        }

        // Update profile UI
        function updateProfileUI(userData) {
            document.getElementById('profileName').textContent = userData.fullName;
            document.getElementById('profileUsername').textContent = '@' + userData.nickname;
            document.getElementById('memberSince').textContent = userData.memberSince.toDate().getFullYear();
            document.getElementById('reviewsCount').textContent = userData.reviewsCount || 0;
            document.getElementById('daysActive').textContent = userData.daysActive || 1;
            document.getElementById('contributionScore').textContent = userData.contributionScore || 10;

            // Update avatar
            const profileAvatarLarge = document.getElementById('profileAvatarLarge');
            const userAvatarElement = document.getElementById('userAvatar');

            if (userData.avatarUrl) {
                profileAvatarLarge.innerHTML = `<img src="${userData.avatarUrl}" alt="Avatar">`;
                userAvatarElement.innerHTML = `<img src="${userData.avatarUrl}" alt="Avatar">`;
            } else {
                profileAvatarLarge.innerHTML = '<i class="fas fa-user"></i>';
                userAvatarElement.innerHTML = '<i class="fas fa-user"></i>';
            }
        }

        // Load disaster cards
        function loadDisasterCards() {
            const disasters = [
                {
                    id: 'floods',
                    title: 'Enchentes',
                    icon: 'fas fa-water',
                    description: 'Inundações causadas por chuvas intensas, transbordamento de rios ou falhas em barragens.',
                    image: '',
                    detailedDescription: 'As enchentes são desastres naturais que ocorrem quando há um transbordamento de água em áreas normalmente secas. Podem ser causadas por chuvas intensas, derretimento de neve, furacões ou falhas em barragens. As enchentes são um dos desastres naturais mais comuns e podem causar danos significativos à propriedade, infraestrutura e perda de vidas.'
                },
                {
                    id: 'droughts',
                    title: 'Seca',
                    icon: 'fas fa-sun',
                    description: 'Períodos prolongados de escassez de água que afetam ecossistemas e comunidades.',
                    image: '',
                    detailedDescription: 'A seca é um fenômeno climático caracterizado por uma prolongada escassez de água, seja atmosférica, superficial ou subterrânea. Pode durar meses ou anos e tem impactos significativos na agricultura, ecossistemas e abastecimento de água para populações humanas. As secas podem ser agravadas pelas mudanças climáticas e pelo uso insustentável dos recursos hídricos.'
                },
                {
                    id: 'fires',
                    title: 'Incêndios Florestais',
                    icon: 'fas fa-fire',
                    description: 'Queimadas descontroladas que consomem grandes áreas de vegetação.',
                    image: '',
                    detailedDescription: 'Incêndios florestais são fogos não controlados que ocorrem em áreas de vegetação florestal. Podem ser causados por fatores naturais (como raios) ou atividades humanas (como queimadas não controladas). Estes incêndios podem se espalhar rapidamente, consumindo milhares de hectares e causando danos significativos à biodiversidade, qualidade do ar e propriedades.'
                },
                {
                    id: 'earthquakes',
                    title: 'Terremotos',
                    icon: 'fas fa-mountain',
                    description: 'Tremores causados pelo movimento das placas tectônicas da Terra.',
                    image: '',
                    detailedDescription: 'Terremotos são vibrações ou tremores na superfície da Terra resultantes do súbito movimento das placas tectônicas. A magnitude dos terremotos é medida na escala Richter, que varia de 1 a 10. Terremotos podem causar destruição massiva de edifícios, infraestrutura e perda de vidas humanas. Eles também podem desencadear tsunamis quando ocorrem no oceano.'
                },
                {
                    id: 'hurricanes',
                    title: 'Furacões',
                    icon: 'fas fa-wind',
                    description: 'Tempestades tropicais intensas com ventos de alta velocidade.',
                    image: '',
                    detailedDescription: 'Furacões, também conhecidos como ciclones tropicais ou tufões, são sistemas de tempestades caracterizados por um centro de baixa pressão, ventos fortes e uma espiral de tempestades que produzem chuva intensa. Estes fenômenos se formam sobre oceanos tropicais quentes e podem causar danos catastróficos quando atingem áreas costeiras, com ventos que podem exceder 250 km/h.'
                },
                {
                    id: 'landslides',
                    title: 'Deslizamentos',
                    icon: 'fas fa-mountain',
                    description: 'Movimento de massa de terra, rochas ou detritos encosta abaixo.',
                    image: '',
                    detailedDescription: 'Deslizamentos de terra são fenômenos geológicos que envolvem o movimento de massa de rocha, detritos ou terra encosta abaixo. Podem ser desencadeados por chuvas intensas, terremotos, atividades vulcânicas ou intervenções humanas. Os deslizamentos podem enterrar casas, estradas e comunidades inteiras, resultando em significativa perda de vidas e danos materiais.'
                }
            ];

            // Load disaster content from Firestore
            db.collection('disasters').get()
                .then(snapshot => {
                    const disasterData = {};
                    snapshot.forEach(doc => {
                        disasterData[doc.id] = doc.data();
                    });

                    // Render disaster cards
                    disasterGrid.innerHTML = '';
                    disasters.forEach(disaster => {
                        const disasterFromDB = disasterData[disaster.id] || {};
                        const card = createDisasterCard({
                            ...disaster,
                            ...disasterFromDB
                        });
                        disasterGrid.appendChild(card);
                    });
                })
                .catch(error => {
                    console.error('Error loading disasters:', error);
                    
                    // Render with default data if error
                    disasterGrid.innerHTML = '';
                    disasters.forEach(disaster => {
                        const card = createDisasterCard(disaster);
                        disasterGrid.appendChild(card);
                    });
                });
        }

        // Create disaster card
        function createDisasterCard(disaster) {
            const card = document.createElement('div');
            card.className = 'disaster-card';
            card.setAttribute('data-id', disaster.id);
            
            card.innerHTML = `
                <div class="disaster-icon">
                    <i class="${disaster.icon}"></i>
                </div>
                <h3>${disaster.title}</h3>
                <p>${disaster.description}</p>
                <a href="#" class="learn-more" onclick="openDisasterDetail('${disaster.id}'); return false;">
                    Saiba mais <i class="fas fa-arrow-right"></i>
                </a>
            `;
            
            return card;
        }

        // Open disaster detail
        function openDisasterDetail(disasterId) {
            currentDisasterId = disasterId;
            
            // Load disaster data
            db.collection('disasters').doc(disasterId).get()
                .then(doc => {
                    if (doc.exists) {
                        const disaster = doc.data();
                        showDisasterDetail(disaster);
                    } else {
                        // Use default data if not in database
                        const defaultDisasters = {
                            floods: {
                                title: 'Enchentes',
                                image: '',
                                detailedDescription: 'As enchentes são desastres naturais que ocorrem quando há um transbordamento de água em áreas normalmente secas. Podem ser causadas por chuvas intensas, derretimento de neve, furacões ou falhas em barragens. As enchentes são um dos desastres naturais mais comuns e podem causar danos significativos à propriedade, infraestrutura e perda de vidas.'
                            },
                            droughts: {
                                title: 'Seca',
                                image: '',
                                detailedDescription: 'A seca é um fenômeno climático caracterizado por uma prolongada escassez de água, seja atmosférica, superficial ou subterrânea. Pode durar meses ou anos e tem impactos significativos na agricultura, ecossistemas e abastecimento de água para populações humanas. As secas podem ser agravadas pelas mudanças climáticas e pelo uso insustentável dos recursos hídricos.'
                            },
                            fires: {
                                title: 'Incêndios Florestais',
                                image: '',
                                detailedDescription: 'Incêndios florestais são fogos não controlados que ocorrem em áreas de vegetação florestal. Podem ser causados por fatores naturais (como raios) ou atividades humanas (como queimadas não controladas). Estes incêndios podem se espalhar rapidamente, consumindo milhares de hectares e causando danos significativos à biodiversidade, qualidade do ar e propriedades.'
                            },
                            earthquakes: {
                                title: 'Terremotos',
                                image: '',
                                detailedDescription: 'Terremotos são vibrações ou tremores na superfície da Terra resultantes do súbito movimento das placas tectônicas. A magnitude dos terremotos é medida na escala Richter, que varia de 1 a 10. Terremotos podem causar destruição massiva de edifícios, infraestrutura e perda de vidas humanas. Eles também podem desencadear tsunamis quando ocorrem no oceano.'
                            },
                            hurricanes: {
                                title: 'Furacões',
                                image: '',
                                detailedDescription: 'Furacões, também conhecidos como ciclones tropicais ou tufões, são sistemas de tempestades caracterizados por um centro de baixa pressão, ventos fortes e uma espiral de tempestades que produzem chuva intensa. Estes fenômenos se formam sobre oceanos tropicais quentes e podem causar danos catastróficos quando atingem áreas costeiras, com ventos que podem exceder 250 km/h.'
                            },
                            landslides: {
                                title: 'Deslizamentos',
                                image: '',
                                detailedDescription: 'Deslizamentos de terra são fenômenos geológicos que envolvem o movimento de massa de rocha, detritos ou terra encosta abaixo. Podem ser desencadeados por chuvas intensas, terremotos, atividades vulcânicas ou intervenções humanas. Os deslizamentos podem enterrar casas, estradas e comunidades inteiras, resultando em significativa perda de vidas e danos materiais.'
                            }
                        };
                        
                        showDisasterDetail(defaultDisasters[disasterId]);
                    }
                })
                .catch(error => {
                    console.error('Error loading disaster detail:', error);
                });
        }

        // Show disaster detail
        function showDisasterDetail(disaster) {
            document.getElementById('disasterDetailTitle').textContent = disaster.title;
            document.getElementById('disasterDetailText').textContent = disaster.detailedDescription;
            
            const imageElement = document.getElementById('disasterDetailImage');
            if (disaster.image) {
                imageElement.src = disaster.image;
            } else {
                imageElement.src = '';
                imageElement.alt = 'Imagem não disponível';
            }
            
            // Show admin controls if user is admin
            const adminControls = document.getElementById('disasterAdminControls');
            if (isAdmin) {
                adminControls.style.display = 'flex';
            } else {
                adminControls.style.display = 'none';
            }
            
            document.getElementById('disasterDetailModal').classList.add('show');
        }

        // Close disaster detail
        function closeDisasterDetail() {
            document.getElementById('disasterDetailModal').classList.remove('show');
        }

        // Edit disaster content (admin only)
        function editDisasterContent() {
            closeDisasterDetail();
            
            // Set the disaster select to the current disaster
            document.getElementById('disasterSelect').value = currentDisasterId;
            
            // Load current content
            db.collection('disasters').doc(currentDisasterId).get()
                .then(doc => {
                    if (doc.exists) {
                        const disaster = doc.data();
                        document.getElementById('disasterDescription').value = disaster.detailedDescription || '';
                        
                        if (disaster.image) {
                            document.getElementById('previewImg').src = disaster.image;
                            document.getElementById('disasterImagePreview').style.display = 'block';
                        }
                    }
                })
                .catch(error => {
                    console.error('Error loading disaster for edit:', error);
                });
            
            // Scroll to admin panel
            document.getElementById('adminPanel').scrollIntoView({ behavior: 'smooth' });
        }

        // Load gallery
        function loadGallery() {
            // This would typically load from Firestore
            // For now, we'll create placeholder items
            galleryGrid.innerHTML = '';
            
            for (let i = 0; i < 6; i++) {
                const galleryItem = document.createElement('div');
                galleryItem.className = 'gallery-item';
                galleryItem.innerHTML = `
                    <div class="gallery-placeholder">
                        <i class="fas fa-image"></i>
                    </div>
                `;
                galleryGrid.appendChild(galleryItem);
            }
        }

        // Load reviews
        function loadReviews() {
            db.collection('reviews').orderBy('timestamp', 'desc').get()
                .then(snapshot => {
                    reviewsList.innerHTML = '';
                    
                    if (snapshot.empty) {
                        reviewsList.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">Nenhuma avaliação ainda. Seja o primeiro a avaliar!</p>';
                        return;
                    }
                    
                    snapshot.forEach(doc => {
                        const review = doc.data();
                        const reviewElement = createReviewElement(review, doc.id);
                        reviewsList.appendChild(reviewElement);
                    });
                    
                    // Load admin reviews list if user is admin
                    if (isAdmin) {
                        loadAdminReviewsList();
                    }
                })
                .catch(error => {
                    console.error('Error loading reviews:', error);
                    reviewsList.innerHTML = '<p style="text-align: center; color: var(--danger-color);">Erro ao carregar avaliações.</p>';
                });
        }

        // Create review element
        function createReviewElement(review, reviewId) {
            const reviewElement = document.createElement('div');
            reviewElement.className = 'review-item';
            reviewElement.setAttribute('data-id', reviewId);
            
            // Format date
            const date = review.timestamp.toDate();
            const formattedDate = date.toLocaleDateString('pt-BR');
            
            // Create stars HTML
            let starsHtml = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= review.rating) {
                    starsHtml += '<i class="fas fa-star"></i>';
                } else {
                    starsHtml += '<i class="far fa-star"></i>';
                }
            }
            
            reviewElement.innerHTML = `
                <div class="review-header">
                    <div class="review-user">
                        <div class="review-avatar">
                            ${review.avatarUrl ? 
                                `<img src="${review.avatarUrl}" alt="${review.name}">` : 
                                `<i class="fas fa-user"></i>`
                            }
                        </div>
                        <div class="review-info">
                            <h4>${review.name}</h4>
                            <div class="review-rating">
                                ${starsHtml}
                            </div>
                        </div>
                    </div>
                    <div class="review-date">${formattedDate}</div>
                </div>
                <div class="review-text">${review.text}</div>
                <button class="delete-review ${isAdmin ? 'show' : ''}" onclick="deleteReview('${reviewId}')">
                    <i class="fas fa-trash"></i> Excluir
                </button>
            `;
            
            return reviewElement;
        }

        // Load admin reviews list
        function loadAdminReviewsList() {
            const adminReviewsList = document.getElementById('adminReviewsList');
            
            db.collection('reviews').orderBy('timestamp', 'desc').get()
                .then(snapshot => {
                    adminReviewsList.innerHTML = '';
                    
                    if (snapshot.empty) {
                        adminReviewsList.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">Nenhuma avaliação para gerenciar.</p>';
                        return;
                    }
                    
                    snapshot.forEach(doc => {
                        const review = doc.data();
                        const reviewElement = createAdminReviewElement(review, doc.id);
                        adminReviewsList.appendChild(reviewElement);
                    });
                })
                .catch(error => {
                    console.error('Error loading admin reviews:', error);
                    adminReviewsList.innerHTML = '<p style="text-align: center; color: var(--danger-color);">Erro ao carregar avaliações.</p>';
                });
        }

        // Create admin review element
        function createAdminReviewElement(review, reviewId) {
            const reviewElement = document.createElement('div');
            reviewElement.className = 'review-item';
            
            // Format date
            const date = review.timestamp.toDate();
            const formattedDate = date.toLocaleDateString('pt-BR');
            
            // Create stars HTML
            let starsHtml = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= review.rating) {
                    starsHtml += '<i class="fas fa-star"></i>';
                } else {
                    starsHtml += '<i class="far fa-star"></i>';
                }
            }
            
            reviewElement.innerHTML = `
                <div class="review-header">
                    <div class="review-user">
                        <div class="review-avatar">
                            ${review.avatarUrl ? 
                                `<img src="${review.avatarUrl}" alt="${review.name}">` : 
                                `<i class="fas fa-user"></i>`
                            }
                        </div>
                        <div class="review-info">
                            <h4>${review.name}</h4>
                            <div class="review-rating">
                                ${starsHtml}
                            </div>
                        </div>
                    </div>
                    <div class="review-date">${formattedDate}</div>
                </div>
                <div class="review-text">${review.text}</div>
                <div class="admin-controls">
                    <button class="btn-primary" onclick="deleteReview('${reviewId}')">
                        <i class="fas fa-trash"></i> Excluir
                    </button>
                </div>
            `;
            
            return reviewElement;
        }

        // Load video
        function loadVideo() {
            db.collection('settings').doc('video').get()
                .then(doc => {
                    if (doc.exists) {
                        const videoData = doc.data();
                        if (videoData.url) {
                            videoPlaceholder.style.display = 'none';
                            videoContainer.innerHTML = `
                                <iframe 
                                    width="100%" 
                                    height="100%" 
                                    src="${videoData.url}" 
                                    frameborder="0" 
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                    allowfullscreen>
                                </iframe>
                            `;
                        }
                    }
                })
                .catch(error => {
                    console.error('Error loading video:', error);
                });
        }

        // Save video URL (admin only)
        function saveVideoUrl() {
            if (!isAdmin) return;
            
            const videoUrl = document.getElementById('videoUrl').value;
            
            if (!videoUrl) {
                alert('Por favor, insira uma URL válida do YouTube.');
                return;
            }
            
            db.collection('settings').doc('video').set({
                url: videoUrl,
                updatedAt: new Date()
            })
            .then(() => {
                alert('URL do vídeo salva com sucesso!');
                loadVideo(); // Reload the video
            })
            .catch(error => {
                console.error('Error saving video URL:', error);
                alert('Erro ao salvar URL do vídeo.');
            });
        }

        // Save disaster content (admin only)
        function saveDisasterContent() {
            if (!isAdmin) return;
            
            const disasterId = document.getElementById('disasterSelect').value;
            const description = document.getElementById('disasterDescription').value;
            const imageFile = document.getElementById('disasterImageInput').files[0];
            
            if (!description) {
                alert('Por favor, insira uma descrição para o desastre.');
                return;
            }
            
            // If there's an image file, upload it first
            if (imageFile) {
                const storageRef = storage.ref();
                const imageRef = storageRef.child(`disasters/${disasterId}/${imageFile.name}`);
                
                showLoading();
                
                imageRef.put(imageFile)
                    .then(snapshot => {
                        return snapshot.ref.getDownloadURL();
                    })
                    .then(imageUrl => {
                        // Save disaster data with image URL
                        return db.collection('disasters').doc(disasterId).set({
                            detailedDescription: description,
                            image: imageUrl,
                            updatedAt: new Date()
                        }, { merge: true });
                    })
                    .then(() => {
                        hideLoading();
                        alert('Conteúdo do desastre salvo com sucesso!');
                        resetDisasterContent();
                        loadDisasterCards(); // Reload disaster cards
                    })
                    .catch(error => {
                        hideLoading();
                        console.error('Error saving disaster content:', error);
                        alert('Erro ao salvar conteúdo do desastre.');
                    });
            } else {
                // Save disaster data without new image
                db.collection('disasters').doc(disasterId).set({
                    detailedDescription: description,
                    updatedAt: new Date()
                }, { merge: true })
                .then(() => {
                    alert('Conteúdo do desastre salvo com sucesso!');
                    resetDisasterContent();
                    loadDisasterCards(); // Reload disaster cards
                })
                .catch(error => {
                    console.error('Error saving disaster content:', error);
                    alert('Erro ao salvar conteúdo do desastre.');
                });
            }
        }

        // Reset disaster content form
        function resetDisasterContent() {
            document.getElementById('disasterDescription').value = '';
            document.getElementById('disasterImageInput').value = '';
            document.getElementById('disasterImagePreview').style.display = 'none';
        }

        // Preview disaster image
        function previewDisasterImage(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('previewImg').src = e.target.result;
                    document.getElementById('disasterImagePreview').style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        }

        // Delete review (admin only)
        function deleteReview(reviewId) {
            if (!isAdmin && !confirm('Tem certeza que deseja excluir esta avaliação?')) {
                return;
            }
            
            if (isAdmin || confirm('Tem certeza que deseja excluir sua avaliação?')) {
                db.collection('reviews').doc(reviewId).delete()
                    .then(() => {
                        alert('Avaliação excluída com sucesso!');
                        loadReviews(); // Reload reviews
                    })
                    .catch(error => {
                        console.error('Error deleting review:', error);
                        alert('Erro ao excluir avaliação.');
                    });
            }
        }

        // Submit review
        document.getElementById('submitReview').addEventListener('click', function() {
            if (!currentUser) {
                alert('Por favor, faça login para enviar uma avaliação.');
                return;
            }
            
            const name = document.getElementById('reviewName').value;
            const text = document.getElementById('reviewText').value;
            
            if (!name || !text || selectedRating === 0) {
                alert('Por favor, preencha todos os campos e selecione uma classificação.');
                return;
            }
            
            // Get user data for avatar
            db.collection('users').doc(currentUser.uid).get()
                .then(doc => {
                    const userData = doc.data();
                    
                    // Save review
                    return db.collection('reviews').add({
                        userId: currentUser.uid,
                        name: name,
                        text: text,
                        rating: selectedRating,
                        avatarUrl: userData.avatarUrl || '',
                        timestamp: new Date()
                    });
                })
                .then(() => {
                    // Update user's review count
                    return db.collection('users').doc(currentUser.uid).update({
                        reviewsCount: firebase.firestore.FieldValue.increment(1),
                        contributionScore: firebase.firestore.FieldValue.increment(10)
                    });
                })
                .then(() => {
                    alert('Avaliação enviada com sucesso!');
                    
                    // Reset form
                    document.getElementById('reviewName').value = '';
                    document.getElementById('reviewText').value = '';
                    setRating(0);
                    
                    // Reload reviews and profile
                    loadReviews();
                    loadUserProfile(currentUser.uid);
                })
                .catch(error => {
                    console.error('Error submitting review:', error);
                    alert('Erro ao enviar avaliação.');
                });
        });

        // Toggle profile section
        function toggleProfile() {
            if (profileSection.classList.contains('show')) {
                profileSection.classList.remove('show');
            } else {
                profileSection.classList.add('show');
                profileSection.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Open settings modal
        function openSettings() {
            document.getElementById('settingsModal').classList.add('show');
        }

        // Close settings modal
        function closeSettings() {
            document.getElementById('settingsModal').classList.remove('show');
        }

        // Open edit profile modal
        function openEditProfile() {
            // Load current user data
            db.collection('users').doc(currentUser.uid).get()
                .then(doc => {
                    if (doc.exists) {
                        const userData = doc.data();
                        document.getElementById('editFullName').value = userData.fullName || '';
                        document.getElementById('editNickname').value = userData.nickname || '';
                        document.getElementById('editEmail').value = userData.email || '';
                        
                        const avatarPreview = document.getElementById('editAvatarPreview');
                        if (userData.avatarUrl) {
                            avatarPreview.innerHTML = `<img src="${userData.avatarUrl}" alt="Avatar">`;
                        } else {
                            avatarPreview.innerHTML = '<i class="fas fa-user"></i>';
                        }
                    }
                })
                .catch(error => {
                    console.error('Error loading user data for edit:', error);
                });
            
            document.getElementById('editProfileModal').classList.add('show');
        }

        // Close edit profile modal
        function closeEditProfile() {
            document.getElementById('editProfileModal').classList.remove('show');
        }

        // Save profile changes
        function saveProfile() {
            const fullName = document.getElementById('editFullName').value;
            const nickname = document.getElementById('editNickname').value;
            const email = document.getElementById('editEmail').value;
            const avatarFile = document.getElementById('editAvatarInput').files[0];
            
            if (!fullName || !nickname || !email) {
                alert('Por favor, preencha todos os campos obrigatórios.');
                return;
            }
            
            const updateData = {
                fullName: fullName,
                nickname: nickname,
                email: email
            };
            
            // If there's an avatar file, upload it first
            if (avatarFile) {
                const storageRef = storage.ref();
                const avatarRef = storageRef.child(`avatars/${currentUser.uid}/${avatarFile.name}`);
                
                showLoading();
                
                avatarRef.put(avatarFile)
                    .then(snapshot => {
                        return snapshot.ref.getDownloadURL();
                    })
                    .then(avatarUrl => {
                        updateData.avatarUrl = avatarUrl;
                        return db.collection('users').doc(currentUser.uid).update(updateData);
                    })
                    .then(() => {
                        hideLoading();
                        alert('Perfil atualizado com sucesso!');
                        closeEditProfile();
                        loadUserProfile(currentUser.uid);
                    })
                    .catch(error => {
                        hideLoading();
                        console.error('Error updating profile:', error);
                        alert('Erro ao atualizar perfil.');
                    });
            } else {
                // Update without new avatar
                db.collection('users').doc(currentUser.uid).update(updateData)
                    .then(() => {
                        alert('Perfil atualizado com sucesso!');
                        closeEditProfile();
                        loadUserProfile(currentUser.uid);
                    })
                    .catch(error => {
                        console.error('Error updating profile:', error);
                        alert('Erro ao atualizar perfil.');
                    });
            }
        }

        // Preview avatar during registration
        function previewAvatar(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('avatarPreview').innerHTML = `<img src="${e.target.result}" alt="Avatar">`;
                };
                reader.readAsDataURL(file);
            }
        }

        // Preview avatar during profile edit
        function previewEditAvatar(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('editAvatarPreview').innerHTML = `<img src="${e.target.result}" alt="Avatar">`;
                };
                reader.readAsDataURL(file);
            }
        }

        // Logout
        function logout() {
            auth.signOut()
                .then(() => {
                    currentUser = null;
                    isAdmin = false;
                    showAuthSection();
                    closeSettings();
                })
                .catch(error => {
                    console.error('Error signing out:', error);
                });
        }

        // Admin tab switching
        document.querySelectorAll('.admin-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Remove active class from all tabs
                document.querySelectorAll('.admin-tab').forEach(t => {
                    t.classList.remove('active');
                });
                
                // Add active class to clicked tab
                this.classList.add('active');
                
                // Hide all content
                document.querySelectorAll('.admin-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // Show corresponding content
                const tabId = this.getAttribute('data-tab');
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });

        // Register form submission
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const fullName = document.getElementById('registerFullName').value;
            const nickname = document.getElementById('registerNickname').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const avatarFile = document.getElementById('avatarInput').files[0];
            
            if (!fullName || !nickname || !email || !password) {
                alert('Por favor, preencha todos os campos obrigatórios.');
                return;
            }
            
            showLoading();
            
            // Create user with email and password
            auth.createUserWithEmailAndPassword(email, password)
                .then(userCredential => {
                    const user = userCredential.user;
                    
                    // If there's an avatar file, upload it
                    if (avatarFile) {
                        const storageRef = storage.ref();
                        const avatarRef = storageRef.child(`avatars/${user.uid}/${avatarFile.name}`);
                        
                        return avatarRef.put(avatarFile)
                            .then(snapshot => {
                                return snapshot.ref.getDownloadURL();
                            })
                            .then(avatarUrl => {
                                // Create user profile with avatar
                                return db.collection('users').doc(user.uid).set({
                                    fullName: fullName,
                                    nickname: nickname,
                                    email: email,
                                    avatarUrl: avatarUrl,
                                    memberSince: new Date(),
                                    reviewsCount: 0,
                                    daysActive: 1,
                                    contributionScore: 10
                                });
                            });
                    } else {
                        // Create user profile without avatar
                        return db.collection('users').doc(user.uid).set({
                            fullName: fullName,
                            nickname: nickname,
                            email: email,
                            avatarUrl: '',
                            memberSince: new Date(),
                            reviewsCount: 0,
                            daysActive: 1,
                            contributionScore: 10
                        });
                    }
                })
                .then(() => {
                    hideLoading();
                    alert('Conta criada com sucesso!');
                    showMainContent();
                })
                .catch(error => {
                    hideLoading();
                    console.error('Error creating account:', error);
                    
                    let errorMessage = 'Erro ao criar conta.';
                    if (error.code === 'auth/email-already-in-use') {
                        errorMessage = 'Este email já está em uso.';
                    } else if (error.code === 'auth/weak-password') {
                        errorMessage = 'A senha é muito fraca. Use pelo menos 6 caracteres.';
                    } else if (error.code === 'auth/invalid-email') {
                        errorMessage = 'Email inválido.';
                    }
                    
                    alert(errorMessage);
                });
        });

        // Login form submission
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                alert('Por favor, preencha todos os campos.');
                return;
            }
            
            showLoading();
            
            auth.signInWithEmailAndPassword(email, password)
                .then(userCredential => {
                    hideLoading();
                    // Auth state listener will handle the rest
                })
                .catch(error => {
                    hideLoading();
                    console.error('Error signing in:', error);
                    
                    let errorMessage = 'Erro ao fazer login.';
                    if (error.code === 'auth/user-not-found') {
                        errorMessage = 'Usuário não encontrado.';
                    } else if (error.code === 'auth/wrong-password') {
                        errorMessage = 'Senha incorreta.';
                    } else if (error.code === 'auth/invalid-email') {
                        errorMessage = 'Email inválido.';
                    }
                    
                    alert(errorMessage);
                });
        });

        // Theme switching
        document.querySelectorAll('.color-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.color-option').forEach(opt => {
                    opt.classList.remove('active');
                });
                this.classList.add('active');
                
                const theme = this.getAttribute('data-theme');
                applyTheme(theme);
            });
        });

        // Apply theme
        function applyTheme(theme) {
            const root = document.documentElement;
            
            switch(theme) {
                case 'dark':
                    root.style.setProperty('--primary-bg', '#000000');
                    root.style.setProperty('--secondary-bg', '#1c1c1e');
                    root.style.setProperty('--tertiary-bg', '#2c2c2e');
                    break;
                case 'darker':
                    root.style.setProperty('--primary-bg', '#0a0a0a');
                    root.style.setProperty('--secondary-bg', '#151515');
                    root.style.setProperty('--tertiary-bg', '#252525');
                    break;
                case 'gray':
                    root.style.setProperty('--primary-bg', '#1a1a1a');
                    root.style.setProperty('--secondary-bg', '#2a2a2a');
                    root.style.setProperty('--tertiary-bg', '#3a3a3a');
                    break;
                case 'black':
                    root.style.setProperty('--primary-bg', '#000000');
                    root.style.setProperty('--secondary-bg', '#121212');
                    root.style.setProperty('--tertiary-bg', '#1e1e1e');
                    break;
            }
            
            // Save theme preference
            localStorage.setItem('theme', theme);
        }

        // Load saved theme
        function loadSavedTheme() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                applyTheme(savedTheme);
                
                // Update active theme button
                document.querySelectorAll('.color-option').forEach(option => {
                    if (option.getAttribute('data-theme') === savedTheme) {
                        option.classList.add('active');
                    } else {
                        option.classList.remove('active');
                    }
                });
            }
        }

        // Font switching
        document.querySelectorAll('.font-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.font-option').forEach(opt => {
                    opt.classList.remove('active');
                });
                this.classList.add('active');
                
                const font = this.getAttribute('data-font');
                applyFont(font);
            });
        });

        // Apply font
        function applyFont(font) {
            const root = document.documentElement;
            
            switch(font) {
                case 'system':
                    root.style.setProperty('--font-family', "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif");
                    break;
                case 'roboto':
                    root.style.setProperty('--font-family', "'Roboto', sans-serif");
                    break;
                case 'open-sans':
                    root.style.setProperty('--font-family', "'Open Sans', sans-serif");
                    break;
                case 'montserrat':
                    root.style.setProperty('--font-family', "'Montserrat', sans-serif");
                    break;
            }
            
            // Save font preference
            localStorage.setItem('font', font);
        }

        // Load saved font
        function loadSavedFont() {
            const savedFont = localStorage.getItem('font');
            if (savedFont) {
                applyFont(savedFont);
                
                // Update active font button
                document.querySelectorAll('.font-option').forEach(option => {
                    if (option.getAttribute('data-font') === savedFont) {
                        option.classList.add('active');
                    } else {
                        option.classList.remove('active');
                    }
                });
            }
        }

        // Load saved preferences
        loadSavedTheme();
        loadSavedFont();
    </script>
</body>
</html>
